#!/usr/bin/env bash
set -e

# Sauvegarde
sudo cp /etc/hosts /etc/hosts.bak || true

# Construit le nouveau contenu et l'écrit EN PLACE (pas de mv, pas de sed -i)
{
  echo "127.0.0.2 localhost"
  echo "8.8.8.8 facebook.com"
  # Conserve le reste en évitant les doublons de ces deux lignes
  grep -vE '^\s*127\.0\.0\.(1|2)\s+localhost(\s|$)' /etc/hosts.bak \
  | grep -vE '^\s*8\.8\.8\.8\s+facebook\.com(\s|$)'
} | sudo tee /etc/hosts >/dev/null
